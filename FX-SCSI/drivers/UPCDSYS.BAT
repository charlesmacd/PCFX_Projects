ECHO OFF
  echo [2A[2M[1A
  if not exist upcdsys.bat goto NOT_CURRENT
  if "%1"=="" goto NOT_PATH1
  if not "%2"=="" goto NOT_PATH1

  chkpath %1
  if errorlevel 2 goto PATH_IS_ROOT
  if errorlevel 1 goto MSG_PATH_X1

  if not exist %1\NECCD.SYS goto NOT_EXIST_NECCDSYS

  echo.
  echo [2J%1 NECCD.SYStHgCD()ΉhCoɃAbvf[g܂B
  echo.
  echo.
  echo.
  echo.
  pause

  echo [2A[2M[1A
  echo [5m%1 NECCD.SYSAbvf[głB[m

  copy %1\NECCD.SYS %1\NECCD.OLD > NUL
  copy  NECCD.SYS %1 > NUL

  echo [2J
  echo uCXg[I܂Bv
  echo uVXe̍ċNȂĂBv
  echo.
  echo.
  echo.
  echo.
  goto EXIT

:PATH_IS_ROOT
:UPDATE2
  if not exist %1NECCD.SYS goto NOT_EXIST_NECCDSYS

:UPDATE
  echo.
  echo [2J%1 NECCD.SYStHgCD()ΉhCoɃAbvf[g܂B
  echo.
  echo.
  echo.
  echo.
  pause

  echo [2A[2M[1A
  echo [5m%1 NECCD.SYSAbvf[głB[m

  copy %1NECCD.SYS %1NECCD.OLD > NUL
  copy  NECCD.SYS %1NECCD.SYS > NUL
:
  echo [2J
  echo uCXg[I܂Bv
  echo uVXe̍ċNȂĂBv
  echo.
  echo.
  echo.
  echo.
  goto EXIT

:NOT_CURRENT
  echo 
  echo [2J
  echo JghCuȊOUPCDSYSR}hN܂B
  echo foCXhCofBXNĂhCuJghCu
  echo ݒ肵AUPCDSYSR}hsĂB
  echo.
  echo.
  echo.
  echo.
  goto EXIT

:MSG_PATH_X1
:NOT_PATH1
  echo 
  echo [2J
  echo CXg[shCuEfBNgw肳Ă܂B
  echo {MS-DOS CD-ROM Extensions(Ver.2.2ȏ)CXg[Ă
  echo hCuEfBNgw肵ĂB
  echo.
  echo gp: 
  echo    UPCDSYS A:\DOS
  echo    @@܂
  echo    UPCDSYS A:\
  echo.
  echo     ('A:\DOS' A'A:\' ͓{MS-DOS CD-ROM ExtensionsCXg[Ă
  echo     fBNgłB܂wɂ͐΃pXpĂB'A:DOS' ̗l
  echo     ΃pX̎w͂ȂłB)
  echo.
  echo.
  echo.
  echo.
  goto EXIT

:NOT_EXIST_NECCDSYS
  echo 
  echo [2J
  echo w肵hCuEfBNgɓ{MS-DOS CD-ROM ExtensionsZbgAbv
  echo Ă܂B(NECCD.SYS܂łB)
  echo.
  echo hCuEfBNgw肷邩A{MS-DOS CD-ROM Extensions
  echo CXg[AēxUPCDSYSR}hsĂB
  echo.
  echo.
  echo.
  echo.
  goto EXIT

:EXIT
